{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Responsive Chat UI</title>
  <link rel="stylesheet" href="{% static 'css/output.css' %}">
  <style>
    /* Custom utility to enforce a better message bubble container width */
    .message-bubble-container {
        max-width: min(calc(100vw - 100px), 400px); /* Custom max-width for smaller screens */
    }
    @media (min-width: 640px) { /* sm breakpoint */
        .message-bubble-container {
            max-width: min(calc(100vw - 380px), 500px); /* Adjust max-width for larger screens */
        }
    }
  </style>
</head>

<body class="min-h-screen bg-gray-100 antialiased">
  <div class="flex h-screen overflow-hidden">

    <aside id="sidebar"
           class="fixed inset-y-0 left-0 z-50 w-72 lg:w-80 shrink-0 bg-white border-r flex flex-col
                  transform transition-transform duration-300 ease-in-out
                  -translate-x-full lg:translate-x-0 lg:static shadow-xl lg:shadow-none">

      <div class="flex items-center justify-between px-4 py-4 border-b">
        <h1 class="text-xl font-extrabold text-indigo-600">ChatApp</h1>
        <button class="p-2 rounded-full bg-indigo-500 text-white hover:bg-indigo-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
          </svg>
        </button>
      </div>

      <div class="px-4 py-3">
        <div class="flex items-center px-3 py-2 bg-gray-100 rounded-lg focus-within:ring-2 focus-within:ring-indigo-400 transition">
          <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 100-15 7.5 7.5 0 000 15z" />
          </svg>
          <input
            class="flex-1 ml-2 bg-transparent text-sm placeholder-gray-500 focus:outline-none"
            placeholder="Search conversations..." />
        </div>
      </div>

      <div class="flex-1 overflow-y-auto">
        <button class="w-full flex items-center gap-3 px-4 py-3 hover:bg-indigo-50/50 transition duration-150 ease-in-out border-b border-gray-100">
          <img src="https://via.placeholder.com/40"
               class="w-10 h-10 rounded-full object-cover ring-2 ring-transparent group-hover:ring-indigo-500 transition" alt="">
          <div class="flex-1 text-left min-w-0">
            <div class="flex justify-between items-center">
              <p class="text-sm font-semibold text-gray-800 truncate">Dawn Sabrina</p>
              <span class="text-xs text-gray-500 shrink-0">4:00 pm</span>
            </div>
            <p class="text-xs text-gray-500 truncate mt-0.5">Wow really cool</p>
          </div>
        </button>

        <button class="w-full flex items-center gap-3 px-4 py-3 bg-indigo-50 border-l-4 border-indigo-600">
          <img src="https://via.placeholder.com/40"
               class="w-10 h-10 rounded-full object-cover ring-2 ring-indigo-600" alt="">
          <div class="flex-1 text-left min-w-0">
            <div class="flex justify-between items-center">
              <p class="text-sm font-bold text-indigo-700 truncate">Devon Felix</p>
              <span class="text-xs font-semibold text-indigo-600 shrink-0">Now</span>
            </div>
            <p class="text-xs font-medium text-emerald-500 truncate mt-0.5">Typing...</p>
          </div>
        </button>

        <button class="w-full flex items-center gap-3 px-4 py-3 hover:bg-indigo-50/50 transition duration-150 ease-in-out border-b border-gray-100">
          <img src="https://via.placeholder.com/40"
               class="w-10 h-10 rounded-full object-cover" alt="">
          <div class="flex-1 text-left min-w-0">
            <div class="flex justify-between items-center">
              <p class="text-sm font-bold text-gray-900 truncate">Dylan Billy</p>
              <span class="text-xs text-gray-500 shrink-0">4:00 pm</span>
            </div>
            <p class="text-xs font-semibold text-gray-700 truncate mt-0.5 relative">
                <span class="inline-block bg-red-500 text-white rounded-full px-2 py-0.5 text-[10px] font-bold mr-1">2</span>
                You missed a call
            </p>
          </div>
        </button>
         <button class="w-full flex items-center gap-3 px-4 py-3 hover:bg-indigo-50/50 transition duration-150 ease-in-out border-b border-gray-100">
          <img src="https://via.placeholder.com/40"
               class="w-10 h-10 rounded-full object-cover" alt="">
          <div class="flex-1 text-left min-w-0">
            <div class="flex justify-between items-center">
              <p class="text-sm font-semibold text-gray-800 truncate">Sarah Connor</p>
              <span class="text-xs text-gray-500 shrink-0">Yesterday</span>
            </div>
            <p class="text-xs text-gray-500 truncate mt-0.5">Project details are attached</p>
          </div>
        </button>
      </div>

      <div class="px-4 py-4 border-t bg-gray-50">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <img src="https://via.placeholder.com/36"
                 class="w-9 h-9 rounded-full object-cover ring-2 ring-green-500" alt="">
            <div>
              <p class="text-sm font-bold text-gray-800">You</p>
              <p class="text-xs text-green-500 font-medium">Online</p>
            </div>
          </div>
          <button class="p-2 rounded-full hover:bg-gray-200 text-gray-500">
             <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13.5 3.75a7.5 7.5 0 100 15 7.5 7.5 0 000-15zm8.25 10.5a7.5 7.5 0 11-15 0 7.5 7.5 0 0115 0z" />
             </svg>
          </button>
        </div>
      </div>
    </aside>

    <div id="sidebarBackdrop"
         class="fixed inset-0 bg-black/50 z-40 lg:hidden hidden"></div>

    <main class="flex-1 flex flex-col min-w-0">
      <header class="flex items-center justify-between px-4 sm:px-6 py-3 border-b bg-white shadow-sm shrink-0">
        <div class="flex items-center gap-3">
          <button id="sidebarToggle" class="lg:hidden p-2 rounded-full hover:bg-gray-100 text-gray-600 transition">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M4 6h16M4 12h16M4 18h10" />
            </svg>
          </button>
          <img src="https://via.placeholder.com/40"
               class="w-10 h-10 rounded-full object-cover ring-2 ring-gray-200" alt="">
          <div>
            <p class="text-base font-bold text-gray-900">Dawn Sabrina</p>
            <p class="text-xs text-gray-500">Last seen Dec 16, 2019</p>
          </div>
        </div>
        <div class="flex items-center gap-2 sm:gap-3">
          <button class="p-2 rounded-full hover:bg-gray-100 text-indigo-600 transition">
             <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M15 10l4.552-3.266A1 1 0 0121 7.75V16.25a1 1 0 01-1.448.816L15 14m-4 7l-2-2m0 0l-2-2m2 2l2 2m-2-2l-2 2M3 12h.01M17 12h.01M12 3h.01M12 21h.01M5 5l2 2M19 19l-2-2M5 19l2-2M19 5l-2 2" />
             </svg>
          </button>
          <button class="p-2 rounded-full hover:bg-gray-100 text-indigo-600 transition">
             <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M10.75 3.25a.75.75 0 100 1.5.75.75 0 000-1.5zM12 12a.75.75 0 100-1.5.75.75 0 000 1.5zM13.25 20.75a.75.75 0 100 1.5.75.75 0 000-1.5zM12 3a9 9 0 100 18 9 9 0 000-18zM12 10.5a.75.75 0 100-1.5.75.75 0 000 1.5zM12 16.5a.75.75 0 100-1.5.75.75 0 000 1.5z" />
             </svg>
          </button>
          <button class="p-2 rounded-full hover:bg-gray-100 text-gray-500 transition">
            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M6.75 12a.75.75 0 101.5 0 .75.75 0 00-1.5 0zm4.75 0a.75.75 0 101.5 0 .75.75 0 00-1.5 0zm4.75 0a.75.75 0 101.5 0 .75.75 0 00-1.5 0z" />
            </svg>
          </button>
        </div>
      </header>

      <section class="flex-1 overflow-y-auto px-4 sm:px-8 py-6 bg-gray-50 flex flex-col space-y-4">
        <div class="flex justify-center my-2">
            <span class="text-xs font-medium text-gray-500 bg-gray-200 px-3 py-1 rounded-full shadow-sm">
                Today, 1:00 pm
            </span>
        </div>

        <div class="flex justify-start">
          <div class="flex items-end gap-2">
            <img src="https://via.placeholder.com/32"
                 class="w-8 h-8 rounded-full object-cover shrink-0" alt="">
            <div>
              <div class="message-bubble-container rounded-2xl rounded-bl-none bg-white p-3 text-sm text-gray-800 shadow-md">
                So I found this great video online
              </div>
              <div class="message-bubble-container mt-1 rounded-2xl rounded-bl-none bg-white p-3 text-sm text-gray-800 shadow-md">
                It’s about stopping drugs
              </div>
            </div>
          </div>
        </div>

        <div class="flex justify-end">
          <div class="text-right flex items-end gap-2">
            <div class="message-bubble-container rounded-2xl rounded-br-none bg-indigo-500 p-3 text-sm text-white shadow-md">
              Can you send me a link?
            </div>
          </div>
        </div>

        <div class="flex justify-start">
            <div class="flex items-end gap-2">
                <img src="https://via.placeholder.com/32"
                    class="w-8 h-8 rounded-full object-cover shrink-0" alt="">
                <div class="flex items-center gap-3 rounded-2xl rounded-bl-none bg-white p-3 text-sm shadow-md border border-gray-100 message-bubble-container">
                  <div class="flex items-center justify-center w-10 h-10 rounded-lg bg-indigo-100 text-indigo-600 shrink-0">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                  </div>
                  <div class="min-w-0">
                    <p class="text-sm font-semibold text-gray-900 truncate">lecture-10.mp3</p>
                    <p class="text-xs text-gray-500">52.1 MB · Click to download</p>
                  </div>
                </div>
            </div>
        </div>

        <div class="flex justify-end">
            <div class="inline-flex items-center gap-3 rounded-2xl rounded-br-none bg-indigo-500 px-4 py-3 text-sm text-white shadow-md message-bubble-container">
              <button class="flex items-center justify-center w-8 h-8 rounded-full bg-white/20 hover:bg-white/40 transition shrink-0">
                <svg class="w-4 h-4 ml-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M14.752 11.168l-3.197 2.132A1 1 0 0110 13.007v-4.014a1 1 0 011.555-.832l3.197 2.132a1 1 0 010 1.664zM21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </button>
              <div class="flex-1 min-w-[100px]">
                <div class="h-1.5 rounded-full bg-white/30">
                  <div class="h-1.5 w-3/4 rounded-full bg-white"></div>
                </div>
              </div>
              <span class="text-xs shrink-0">1:00</span>
            </div>
        </div>

        <div class="flex justify-end">
          <div class="text-right flex flex-col items-end gap-1">
            <div class="message-bubble-container rounded-2xl rounded-br-none bg-indigo-500 p-3 text-sm text-white shadow-md">
              How about this one instead?
            </div>
            <div class="flex items-center text-xs text-gray-500">
                <span class="mr-1">Seen</span>
                <svg class="w-3 h-3 text-green-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2c4.142 0 7.632 2.809 8.618 6.984M4.382 17.016A11.955 11.955 0 0012 22c4.142 0 7.632-2.809 8.618-6.984" />
                </svg>
            </div>
          </div>
        </div>
      </section>

      <footer class="px-4 sm:px-8 py-3 bg-white border-t shadow-inner shrink-0">
        <form class="flex items-center gap-3">
          <button type="button" class="p-2 rounded-full bg-gray-100 text-gray-500 hover:bg-gray-200 transition shrink-0">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.414a3 3 0 00-4.242-4.242l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.414" />
            </svg>
          </button>
          <button type="button" class="p-2 rounded-full bg-gray-100 text-gray-500 hover:bg-gray-200 transition shrink-0 hidden sm:block">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </button>
          <input
            class="flex-1 px-4 py-2 text-sm bg-gray-100 rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder-gray-500 transition"
            placeholder="Write your message here..." />
          <button class="flex items-center justify-center w-10 h-10 rounded-full bg-indigo-500 text-white hover:bg-indigo-600 transition shrink-0">
            <svg class="w-5 h-5 ml-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M13 5l7 7-7 7M5 12h14" />
            </svg>
          </button>
        </form>
      </footer>
    </main>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const toggle = document.getElementById('sidebarToggle');
      const sidebar = document.getElementById('sidebar');
      const backdrop = document.getElementById('sidebarBackdrop');
      const lgBreakpoint = 1024; // Tailwind's 'lg' breakpoint

      const closeSidebar = () => {
        sidebar.classList.add('-translate-x-full');
        backdrop.classList.add('hidden');
        document.body.style.overflow = ''; // Restore scrolling
      };

      const openSidebar = () => {
        sidebar.classList.remove('-translate-x-full');
        backdrop.classList.remove('hidden');
        document.body.style.overflow = 'hidden'; // Prevent main content scrolling
      };

      const checkSidebarState = () => {
        // If screen is large or wider, ensure sidebar is visible and backdrop is hidden
        if (window.innerWidth >= lgBreakpoint) {
          sidebar.classList.remove('-translate-x-full');
          backdrop.classList.add('hidden');
          document.body.style.overflow = '';
        } else {
          // If screen is mobile size, ensure sidebar is initially hidden (using the CSS default)
          // but don't force close if it was manually opened. We use the class-based toggle.
          // The CSS handles the default position, so we just manage the manual toggle here.
          if (!sidebar.classList.contains('-translate-x-full') && !backdrop.classList.contains('hidden')) {
              // Sidebar is currently open on a small screen, keep it open, but if resized down
              // from desktop, it should be the hidden default. We rely on CSS for the default.
          } else {
             sidebar.classList.add('-translate-x-full');
             backdrop.classList.add('hidden');
             document.body.style.overflow = '';
          }
        }
      };

      if (toggle && sidebar && backdrop) {
        // 1. Initial check on load
        checkSidebarState();

        // 2. Event listeners for user interaction
        toggle.addEventListener('click', openSidebar);
        backdrop.addEventListener('click', closeSidebar);
        
        // 3. Listen for screen size changes
        window.addEventListener('resize', checkSidebarState);
      }
    });
  </script>
</body>
</html>